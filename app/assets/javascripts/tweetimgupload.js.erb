$(function(){
    $('.form-tweetimg').on('change', 'input[type="file"]', function(e){
        let file = e.target.files[0];
        let reader = new FileReader();
        let $preview = $(".preview-tweetimg");

        if(file.type.indexOf("image") < 0){
            return false;
        }

        reader.onload = function(e){
            $.ajax({
                url: '/tweet_posts/imgsig',
                type: 'POST',
                data: {
                    'media': 'e.target.result',
                    'oauth_callback': location.href,
                    'oauth_nonce': Date.now(),
                    'oauth_timestamp': Math.floor(Date.now() / 1000)
                }
            })
        };

        reader.readAsDataURL(file);
    })
})